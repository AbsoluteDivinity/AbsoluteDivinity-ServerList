
<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>AbsoluteDivnity Server-List</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css">

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Material Design Bootstrap -->
    <link href="css/mdb.min.css" rel="stylesheet">
	<style>
		html, body { background-color: rgba(0,0,0,0); background:url("images/bg.jpg") no-repeat center center fixed;-webkit-background-size:cover;-moz-background-size:cover;-o-background-size:cover;background-size:cover; color: #fff; }
		.table td, .table th {
			border: none;
		}
		.thead-inverse th {
			color: #bfbebe;
			background-color: rgba(0, 0, 0, 0.18);
		}
	</style>
</head>

<body class="fixed-sn purple-skin">

    <!--Main layout-->
    <main>
        <div class="container-fluid">
            <div class="row wow fadeIn">

                <!--Post column-->
                <div class="col-xl-8 col-lg-12 wow fadeIn">

                    <!--Section: Post-->
                    <section class="section section-blog-fw">

                        <!--First row-->
                        <div class="row">
                            <div class="col-md-12 wow fadeIn">
								<div class="table-responsive">
									<table id="serverlist" class="table table-hover text-center wow fadeIn" style="visibility: visible; animation-name: fadeIn;">
										<thead class="thead-inverse">
											<tr>
												<th class="text-center">game</th>
												<th class="text-center">Hostname</th>
												<th class="text-center">Players</th>
											</tr>
										</thead>
										<tbody id="servers">
										</tbody>
									</table>
								</div>
                                
                            </div>
                            
                        </div>
                        <!--/First row-->
                        
                    </section>
                    <!--/Section: Post-->

                </div>
                <!--/Post column-->

                <!--Right sidebar-->
                <div class="col-xl-4 col-lg-12 wow fadeIn">

                        <!--Section: Sidebar widget-->
                        <section>

                            <!--Card-->
                            <div class="card ovf-hidden wow fadeIn" style="background-color: rgba(0,0,0,0);">
								<!--Card image-->
								<div class="view overlay hm-white-slight" style="height: 200px;">
									<img id="server-image" src="" style="width: 100%; height: 100%;" class="img-fluid" alt="">
								</div>
								<!--/.Card image-->
								<!--Card content-->
								<div class="card-block" >
									<!--Title-->
									<h4 class="card-title" id="server-name"></h4>
									<hr>
									<!--Text-->
									<p class="card-text"id="server-info"></p>
									<hr>
									<div id="con">
									</div>
								</div>
								<!--/.Card content-->
							</div>
                            <!--/.Card-->

                        </section>
                        <!--/Section: Sidebar widget-->

                    </div>
                <!--/Right sidebar-->
            </div>
        </div>
    </main>
    <!--/Main layout-->


    <!-- SCRIPTS -->

    <!-- JQuery -->
    <script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>

    <!-- Tooltips -->
    <script type="text/javascript" src="js/tether.min.js"></script>

    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="js/bootstrap.min.js"></script>

    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="js/mdb.min.js"></script>
	<script>
		servers = [];
		function changeText(address, game, id, text, info, info_text, img_id, img)
		{
			var server_name = document.getElementById(id);
			var server_info = document.getElementById(info);
			var server_image = document.getElementById(img_id);
			var server_con = document.getElementById('con');
			server_name.innerHTML = "";
			server_info.innerHTML = "";
			server_image.innerHTML = "";
			server_con.innerHTML = "";
			server_name.innerHTML = text;
			server_info.innerHTML = info_text;
			if(game.toLowerCase() == 'mc')
			{
				server_image.src = 'https://api.absolutedivinity.net/map/'+ game.toLowerCase() +'/' + img.toLowerCase();			
			}
			else
			{
				server_image.src = 'https://api.absolutedivinity.net/map/'+ game.toLowerCase() +'/' + img;
			}
			var addr = 'iw4x://'+address;
			if(game.toLowerCase() == 'iw4'){
				server_con.innerHTML = '<a href="'+addr+'"><button type="button" style="color: #fff!important; width: 100%;" class="btn btn-outline-success waves-effect">Connect</button></a>';
			}	
		}	
		getServers();
		function getServers() {
			var s = 0;
			servers = [];
			$.getJSON('./master.list', function(data) {
				for (var i = 0; i < data.result.length; i++) {
					var serverIP = data.result.servers[i].ip;
					var serverPort = data.result.servers[i].port;
					var game = data.result.servers[i].game;
					$.getJSON('https://api.absolutedivinity.net/server/'+game+'?ip='+serverIP+':'+serverPort, function(serverInfo) {
						servers[s] = {
							"hostname": serverInfo.Hostname.replace('^0', '').replace('^1', '').replace('^2', '').replace('^3', '').replace('^4', '').replace('^5', '').replace('^6', '').replace('^7', '').replace('^8', '').replace('^9', '').replace('^3', ''),
							"map": serverInfo.Map,
							"map_unclean": serverInfo.Map_unclean,
							"gametype": serverInfo.Gamemode,
							"players": serverInfo.Players,
							"maxplayers": serverInfo.MaxPlayers,
							"gamename": serverInfo.Gamename,
							"address": serverInfo.Address
						};
						addServer(s++);
					});
				}
			});
		}
		function addServer(i) {
			if (typeof servers[i] !== 'undefined') {
				document.getElementById('servers').innerHTML += '<tr id="server-'+i+'"><td><img style="height: 20px; box-shadow: 0 0 20px #000;" src="https://api.absolutedivinity.net/icon/'+ servers[i].gamename.toLowerCase() +'"></td><td style="text-shadow: 0 0 20px #000;">'+servers[i].hostname+'</td><td style="text-shadow: 0 0 20px #000;">'+servers[i].players+'/'+servers[i].maxplayers+'</td></tr>';
				$("#servers tr").hover(function () {
					var cid = $(this).attr('id');
					var id = cid.split("-");
					changeText(servers[id[1]].address, servers[id[1]].gamename, "server-name", servers[id[1]].hostname, "server-info", "Map: "+servers[id[1]].map+"<br>Gamemode: "+servers[id[1]].gametype+"<br>Players: "+servers[id[1]].players+"/"+servers[id[1]].maxplayers, "server-image", servers[id[1]].map_unclean);
				});
			}
		}
        $(".button-collapse").sideNav();
        var el = document.querySelector('.custom-scrollbar');
        Ps.initialize(el);
    </script>
    <script>
        new WOW().init();
    </script>

</body>

</html>